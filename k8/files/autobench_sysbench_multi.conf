{{ if gt ($.Values.clusterSize.numMySQLServers | int) 1 }}

{{ $mySQLdHosts := list }}
{{ range $i := until ($.Values.clusterSize.numMySQLServers | int) }}
{{ $mySQLdHosts = append $mySQLdHosts (printf "mysqlds-%d.mysqld.default.svc.cluster.local" $i) }}
{{ end }}
{{ $mySQLdHosts = join ";" $mySQLdHosts }}

{{ include "autobench_sysbench" (dict 
    "mgmdHosts" "mgmds-0.mgmd.default.svc.cluster.local"
    "mySQLdHosts" $mySQLdHosts
    "mysqlUsername" $.Values.benchmarking.mysqlUsername
    "mysqlPassword" $.Values.benchmarking.mysqlPassword
    "mySQLdSlotsPerNode" $.Values.benchmarking.MySQLdSlotsPerNode
    "threadCountsToRun" $.Values.benchmarking.sysbench.threadCountsToRun
    "rows" $.Values.benchmarking.sysbench.rows
    "numMySQLds" $.Values.clusterSize.numMySQLServers
)}}

{{ else }}

# This is not templated since we are running with less than 1 MySQLd.

{{ end }}
